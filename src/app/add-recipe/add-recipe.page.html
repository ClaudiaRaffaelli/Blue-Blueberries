<ion-header no-border>
  <ion-toolbar class="ios hydrated">
    <ion-title class="ios title-ios hydrated">Add Recipe</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <ion-list lines="full">
    <form [formGroup]="recipeForm" (ngSubmit)="formSubmit()">
      <ion-item>
        <ion-label position="floating">Name</ion-label>
        <ion-input formControlName="name" type="text" required></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="floating">Recipe</ion-label>
        <ion-input formControlName="recipeText" type="text" required>
        </ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="floating">Time (min.)</ion-label>
        <ion-input formControlName="recipeTime" type="number" required>
        </ion-input>
      </ion-item>

      <!-- Images selector -->
      <ion-card class="ion-text-center">
        <ion-card-header>
          <ion-card-title>Choose Images to Upload</ion-card-title>
        </ion-card-header>
        <ion-card-content class="insertImage" (change)="uploadFile($event.target.files)">
          <ion-button color="primary" shape="square" expand="block" >
            <input id="uploadBtn" type="file" class="upload" />
          </ion-button>
          Images Uploaded:<br>
          <ion-item *ngFor="let imageName of imagesUploaded" class="user-list">
            <div>
              {{imageName.split('.')[0].substring(0,6)}}... .jpg
              <ion-icon name="cloud-done-outline"></ion-icon>
            </div>
          </ion-item>
        </ion-card-content>
      </ion-card>

      <ion-card>
        <ion-card-content>
        </ion-card-content>
      </ion-card>


      <!-- Default Searchbar -->
      <ion-card padding>
          <ion-label>Selected ingredients:</ion-label>
        <ion-grid *ngFor="let ingredient of recipeForm.value.ingredientsForm.ingredients | keyvalue">
          <ion-row *ngIf="ingredient.value.selected" class="ingredient-row">
            <ion-col size="1" class="ion-align-self-start">
              <ion-icon (click)="toggleIngredient(ingredient.key)" name="trash-sharp" item-end></ion-icon>
            </ion-col>

            <ion-col size="11">
              <ion-row class="ion-align-self-end">
                <ion-col size="5" class="ion-align-self-start">
                  <ion-label color="primary">{{ingredient.key}}</ion-label>
                </ion-col>
                <ion-col size="6" class="ion-align-self-end" style="text-align: right">
                  Quantity <ion-input (ionChange)="changeDose($event, ingredient.key)" debounce="500" type="number" clearInput required></ion-input>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="5">
                </ion-col>
                <ion-col size="6" style="text-align: center">
                  <ion-label> Type <ion-input (ionChange)="changeDoseType($event, ingredient.key)" debounce="500" type="text" clearInput required></ion-input>
                  </ion-label>
                </ion-col>
              </ion-row>
            </ion-col>
          </ion-row>
        </ion-grid>

        <ion-searchbar (ionChange)="_ionChange($event)" animated placeholder="Search ingredients...">
        </ion-searchbar>
        <ion-list *ngIf="showSearchBarResults">
          <ion-item *ngFor="let ingredient of this.ingredients | keyvalue">
            <ion-label color="dark" (click)="toggleIngredient(ingredient.value)">{{ingredient.value}}</ion-label>
            <ion-icon (click)="toggleIngredient(ingredient.value)"
                      [name]="this.recipeForm.value.ingredientsForm.ingredients[ingredient.value].selected ? 'checkmark-sharp' : 'add-outline'" item-end ></ion-icon>
          </ion-item>
        </ion-list>
      </ion-card>

      <ion-row>
        <ion-col>
          <ion-button type="submit" color="success" shape="full" expand="block">Add Recipe</ion-button>
        </ion-col>
      </ion-row>
    </form>



  </ion-list>



</ion-content>
