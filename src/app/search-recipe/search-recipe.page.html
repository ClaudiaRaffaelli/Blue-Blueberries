
  <br>
  <ion-content mode="ios" forceOverscroll="true">
      <!-- SEARCH BY NAME -->
      <ion-card-content>
        <ion-searchbar (ionChange)="onChangeName($event)" debounce="250" animated placeholder="Cake, pasta, ...">
        </ion-searchbar>
      </ion-card-content>

    <h1><ion-item lines="none"><b>Advanced filters</b></ion-item></h1>

      <ion-card>
        <ion-item lines="none">
          Available ingredients <ion-toggle [checked]="searchAvailableIngredients" (ionChange)="toggleSearchAvailableIngredients()" color="secondary" slot="end"></ion-toggle>
        </ion-item>
        <!-- SEARCH BAR -->
        <ion-searchbar *ngIf="searchAvailableIngredients" (ionChange)="_ionChangeAvailable($event)" debounce="250" animated placeholder="Type eggs, milk, ...">
        </ion-searchbar>
        <!-- SPEECH TO TEXT -->
        <ion-grid *ngIf="searchAvailableIngredients"  style="height: 100%">
          <ion-row class="ion-align-items-center">
            <ion-col size="1"></ion-col>
            <ion-col size="10" class="ion-text-center" style="font-size: 12px;">
              <ion-icon name="mic-outline" color="primary"></ion-icon> "<b>I have</b> eggs, milk, ..." <br>
              <!--<ion-button shape="round" color="secondary" (click)="speakIngredients('available')"><ion-icon name="mic-outline"></ion-icon></ion-button>-->
            </ion-col>
            <ion-col size="1"></ion-col>
          </ion-row>
        </ion-grid>
        <!-- AVAILABLE INGREDIENTS SEARCH RESULT -->
        <ion-card-content *ngIf="showAvailableSearchBarResults && searchAvailableIngredients">
        <ion-col size="12">
          <span *ngFor="let ingredient of this.availableIngredients | keyvalue">
            <ion-chip [color]="this.ing.ingredients[ingredient.value].selected ? 'light' : 'dark'">
              <ion-label [color]="this.ing.ingredients[ingredient.value].selected ? 'success' : 'dark'" (click)="toggleAvailableIngredient(ingredient.value)">{{ingredient.value}}</ion-label>
              <ion-icon (click)="toggleAvailableIngredient(ingredient.value)"
                        [name]="this.ing.ingredients[ingredient.value].selected ? 'checkmark-sharp' : 'add-outline'"
                        [color]="this.ing.ingredients[ingredient.value].selected ? 'success' : 'dark'"></ion-icon>
            </ion-chip>
          </span>
        </ion-col>
        </ion-card-content>
        <!-- AVAILABLE INGREDIENTS SELECTED -->
        <ion-card-content *ngIf="searchAvailableIngredients">
        <ion-col size="12">
              <span *ngFor="let ingredient of this.availableIngredientsKeys">
                <span *ngIf="this.ing.ingredients[ingredient].selected">
                  <ion-chip *ngIf="this.ing.ingredients[ingredient].selected" color="success">
                    <ion-label color="success">{{ingredient}}</ion-label>
                    <ion-icon (click)="toggleAvailableIngredient(ingredient)" name="close"></ion-icon>
                  </ion-chip>
                </span>
              </span>
        </ion-col>
        </ion-card-content>
      </ion-card>

      <!-- MAX TIME REQUIRED -->
      <ion-card>
        <ion-item lines="none">
          Max time required<ion-toggle [checked]="searchRequiredTime" (ionChange)="toggleRequiredTime()" color="secondary" slot="end"></ion-toggle>
        </ion-item>
        <ion-list *ngIf="searchRequiredTime" lines="none">
          <ion-item>
            <ion-label>Time</ion-label>
            <ion-datetime *ngIf="this.platform.is('desktop')" mode="ios" (ionChange)="timeRequiredChange($event)" minuteValues="0,5,10,15,30,45,50" displayFormat="HH:mm" pickerFormat="HH mm" value="00:30"></ion-datetime>
            <ion-datetime *ngIf="this.platform.is('android')" mode="md" (ionChange)="timeRequiredChange($event)" minuteValues="0,5,10,15,30,45,50" displayFormat="HH:mm" pickerFormat="HH mm" value="00:30"></ion-datetime>
          </ion-item>
          <ion-row><ion-col size="12"></ion-col></ion-row>
        </ion-list>
      </ion-card>

      <!-- UNDESIRED INGREDIENTS -->
      <ion-card>
        <!-- SEARCH BAR -->
        <ion-item lines="none">
          Undesired ingredients <ion-toggle [checked]="searchUndesiredIngredients" (ionChange)="toggleSearchUndesiredIngredients()" color="secondary" slot="end"></ion-toggle>
        </ion-item>
        <ion-searchbar *ngIf="searchUndesiredIngredients" (ionChange)="_ionChangeUndesired($event)" debounce="250" animated placeholder="Type milk, mushrooms, ...">
        </ion-searchbar>
        <!-- SPEECH TO TEXT -->
        <ion-grid *ngIf="searchUndesiredIngredients" style="height: 100%">
          <ion-row class="ion-align-items-center">
            <ion-col size="1"></ion-col>
            <ion-col size="10" class="ion-text-center" style="font-size: 12px;">
              <ion-icon name="mic-outline" color="primary"></ion-icon>"<b>I don't want</b> butter, lemons, ..."
              <!--<ion-button shape="round" color="secondary" (click)="speakIngredients('undesired')"><ion-icon name="mic-outline"></ion-icon></ion-button>-->
            </ion-col>
            <ion-col size="1"></ion-col>
          </ion-row>
        </ion-grid>
        <!-- UNDESIRED INGREDIENTS SEARCH RESULT -->
        <ion-card-content *ngIf="showUndesiredSearchBarResults && searchUndesiredIngredients" >
        <ion-col size="12">
          <span *ngFor="let ingredient of this.undesiredIngredients | keyvalue">
            <ion-chip [color]="this.ingUndesired.ingredients[ingredient.value].selected ? 'light' : 'dark'">
                <ion-label [color]="this.ingUndesired.ingredients[ingredient.value].selected ? 'danger' : 'dark'" (click)="toggleUndesiredIngredient(ingredient.value)">{{ingredient.value}}</ion-label>
                <ion-icon (click)="toggleUndesiredIngredient(ingredient.value)"
                          [name]="this.ingUndesired.ingredients[ingredient.value].selected ? 'checkmark-outline' : 'add-outline'"
                          [color]="this.ingUndesired.ingredients[ingredient.value].selected ? 'danger' : 'dark'"></ion-icon>
              </ion-chip>
          </span>
        </ion-col>
        </ion-card-content>
        <!-- UNDESIRED INGREDIENTS SELECTED -->
        <ion-card-content *ngIf="searchUndesiredIngredients" >
        <ion-col size="12">
          <span *ngFor="let ingredient of this.undesiredIngredientsKeys">
            <span *ngIf="this.ingUndesired.ingredients[ingredient].selected">
              <ion-chip *ngIf="showUndesiredIngredients && this.ingUndesired.ingredients[ingredient].selected " color="danger">
                <ion-label color="danger">{{ingredient}}</ion-label>
                <ion-icon (click)="toggleUndesiredIngredient(ingredient)" name="close"></ion-icon>
              </ion-chip>
            </span>
          </span>
        </ion-col>
        </ion-card-content>
      </ion-card>
          <!-- DIFFICULTY -->
      <ion-card>
        <ion-item lines="none">
          Difficulty <ion-toggle [checked]="searchDifficulty" (ionChange)="toggleSearchDifficulty()" color="secondary" slot="end"></ion-toggle>
        </ion-item>
          <ion-segment *ngIf="searchDifficulty" (ionChange)="toggleDifficulty($event)" color="dark" [value]="difficulty">
            <ion-segment-button value="easy">
              <ion-label>Easy</ion-label>
            </ion-segment-button>
            <ion-segment-button value="medium">
              <ion-label>Medium</ion-label>
            </ion-segment-button>
            <ion-segment-button value="hard">
              <ion-label>hard</ion-label>
            </ion-segment-button>
          </ion-segment>
        <!-- SPEECH TO TEXT -->
        <ion-grid *ngIf="searchDifficulty" style="height: 100%">
          <ion-row class="ion-align-items-center">
            <ion-col size="1"></ion-col>
            <ion-col size="10" class="ion-text-center" style="font-size: 12px;">
              <ion-icon name="mic-outline" color="primary"></ion-icon> "<b>Set difficulty</b> to <b>medium</b>" <br>
            </ion-col>
            <ion-col size="1"></ion-col>
          </ion-row>
          <ion-row><ion-col size="12"></ion-col></ion-row>
        </ion-grid>
      </ion-card>
<br><br>
      <ion-card id="summary_animated" style="margin: 16px !important;" *ngIf="queryRecipeName !== '' || searchAvailableIngredients|| searchUndesiredIngredients || searchDifficulty || searchRequiredTime">
        <ion-card-header>
          <ion-item lines="none"><ion-icon slot="start" size="large" color="tertiary" name="reader-outline"></ion-icon><h1>Summary</h1></ion-item>
        </ion-card-header>
        <ion-grid>
          <ion-row *ngIf="queryRecipeName !== ''" class="ion-align-items-stretch">
            <ion-col size="1"><ion-icon color="tertiary" name="key-outline"></ion-icon></ion-col>
            <ion-col size="5">Keywords</ion-col>
            <ion-col>
              <b>{{queryRecipeName}}</b>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="searchRequiredTime">
            <ion-col size="1"><ion-icon color="warning" name="hourglass-outline"></ion-icon></ion-col>
            <ion-col size="5">Ready in</ion-col>
            <ion-col size="6">
              <b>{{maxRequiredTime}} minutes </b>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="searchDifficulty">
            <ion-col size="1"><ion-icon color="secondary" name="flame-outline"></ion-icon></ion-col>
            <ion-col size="5">Difficulty</ion-col>
            <ion-col size="6">
              <b>{{difficulty}} </b>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="searchAvailableIngredients">
            <ion-col size="1"><ion-icon color="success" name="thumbs-up-outline"></ion-icon></ion-col>
            <ion-col size="5">I have</ion-col>
            <ion-col size="6">
              <span *ngFor="let ingredient of this.availableIngredientsKeys">
                <span *ngIf="this.ing.ingredients[ingredient].selected">
                  <ion-chip *ngIf="showAvailableIngredients && this.ing.ingredients[ingredient].selected " color="success">
                    <ion-label color="success">{{ingredient}}</ion-label>
                    <ion-icon (click)="toggleAvailableIngredient(ingredient)" name="close"></ion-icon>
                  </ion-chip>
                </span>
              </span>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="searchUndesiredIngredients">
            <ion-col size="1"><ion-icon color="danger" name="thumbs-down-outline"></ion-icon></ion-col>
            <ion-col size="5">
            I don't want
            </ion-col>
            <ion-col size="6">
              <span *ngFor="let ingredient of this.undesiredIngredientsKeys">
                <span *ngIf="this.ingUndesired.ingredients[ingredient].selected">
                  <ion-chip *ngIf="showUndesiredIngredients && this.ingUndesired.ingredients[ingredient].selected " color="danger">
                    <ion-label color="danger">{{ingredient}}</ion-label>
                    <ion-icon (click)="toggleUndesiredIngredient(ingredient)" name="close"></ion-icon>
                  </ion-chip>
                </span>
              </span>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card>


    <ion-grid>
      <ion-row>
        <ion-col size="3"></ion-col>
      <ion-col size="6" class="ion-text-center">
      <ion-button (click)="submit()" shape="round" color="primary">
        Search
        <ion-ripple-effect></ion-ripple-effect>
      </ion-button>
      </ion-col>
        <ion-col size="3"></ion-col>
      </ion-row>
    </ion-grid>

    <ion-fab id="mic_animated" *ngIf="searchAvailableIngredients|| searchUndesiredIngredients" vertical="bottom" horizontal="end" slot="fixed">
      <ion-fab-button *ngIf="voiceActiveSectionDisabled && !speaking" color="primary" (click)="startVoiceRecognition()" mode="ios">
        <ion-icon name="mic-outline" mode="ios" style="font-size: 2em;"></ion-icon>
      </ion-fab-button>
      <ion-fab-button *ngIf="!voiceActiveSectionDisabled && !speaking" color="danger" (click)="closeVoiceRecognition()" mode="ios">
        <ion-icon name="mic-outline" mode="ios" style="font-size: 2em;"></ion-icon>
      </ion-fab-button>
      <ion-fab-button *ngIf="speaking" color="warning" mode="ios">
        <ion-icon name="mic-outline" mode="ios" style="font-size: 2em;"></ion-icon>
      </ion-fab-button>
    </ion-fab>

    <div class="assistant-overlay" *ngIf="speaking || !voiceActiveSectionDisabled">
      <p style="color: #ffffff"><span slot="start" class="ion-text-end">{{voiceTextUser}}</span></p>
    </div>

    <!--
    <div *ngIf="voiceActiveSectionDisabled; else voicesection;">
      <button type=”button” (click)="startVoiceRecognition()">Record</button>
    </div>
    <ng-template #voicesection>
      <ng-container *ngIf="!voiceActiveSectionError; else failure">
        <ng-container *ngIf="voiceText; else start">
          <span>{{voiceText}}</span>
        </ng-container>
        <ng-template #start>
          <ng-container *ngIf="voiceActiveSectionListening; else beginning">
            <span>Listening…</span>
          </ng-container>
          <ng-template #beginning>
            <span>Start talking…</span>
          </ng-template>
        </ng-template>
      </ng-container>
      <ng-template #failure>
        <span>Didn’t catch that</span>
      </ng-template>
      <div>
        <button (click)="closeVoiceRecognition()">Close</button>
        <button (click)="startVoiceRecognition()">Restart</button>
      </div>
    </ng-template>
    -->


  </ion-content>
